<mat-dialog-content>
  <mat-toolbar color="primary">
    <span>Current tasks</span>
    <span class="spacer"></span>
    <button mat-icon-button (click)="closeDialog()">
      <mat-icon>close</mat-icon>
    </button>
  </mat-toolbar>

  <div class="item mat-body-1" *ngFor="let task of tasks">
    <div class="row" *ngIf="!task.finished">
      <span class="item_status">{{ task.status }}</span>
      <span class="spacer"></span>
      <app-marketplace-action-buttons
        *ngIf="task.dataProduct"
        [availableActions]="[task.actionButton]"
        [dataProduct]="task.dataProduct"></app-marketplace-action-buttons>
      <button mat-button *ngIf="task.progress < 100" (click)="task.cancel()">Cancel</button>
    </div>
    <div class="row" *ngIf="task.errors.length">
      <span class="item_status" *ngIf="task.errors[0] === taskError.EncryptionError">Encryption error</span>
      <span class="item_status" *ngIf="task.errors[0] === taskError.ReencryptionError">Re-encryption error</span>
      <span class="item_status" *ngIf="task.errors[0] === taskError.DecryptionError">Decryption error</span>
      <span class="item_status"
            *ngIf="![ taskError.EncryptionError, taskError.ReencryptionError, taskError.DecryptionError ].includes(task.errors[0])">
        {{ task.errors[0] }}</span>
    </div>
    <div class="row">
      <span class="item_name">{{ task.name }}</span>
      <span class="spacer"></span>
      <mat-progress-spinner
        *ngIf="task.progress < 100 && !task.finished"
        mode="determinate"
        [value]="task.progress"
        [strokeWidth]="4"
        [diameter]="24">
      </mat-progress-spinner>
      <mat-icon *ngIf="task.finished && !task.errors.length">check_circle</mat-icon>
      <mat-icon *ngIf="task.finished && task.errors.length">error</mat-icon>
    </div>
  </div>
</mat-dialog-content>
